# PWA-template

NOTE: the submodule cashu.me should NOT be edited in any way - it only exists for reference.

This repo attempts to build a PWA inspired by `Inspiration/cashu.me/` (git submodule). It aims to use the same methodology of the cashu.me PWA to create a template PWA of similar structure and functionality. The main difference is that native builts for any platform are NOT of interest. The point of the PWA is to completely avoid "app stores" - this will instead be web-native and web-only. The point is to be able to create a PWA of similar functionality and style by using cashu.me as a template.

The current functionality of cashu.me should be replaced.  Instead, this template PWA has a few simple features:

  - Show the bitcoin block height with date of last refresh. Button under it to manually update. Settings allow auto-refresh with polling.
  - Show current price of bitcoin (same behavior as above)
  - Currency converter between USD â†” sats (settings menu option to select polling interval)

## APIs Used

- Block height sources (tried in order):
  - `https://mempool.space/api/blocks/tip/height`
  - `https://blockstream.info/api/blocks/tip/height`
  - `https://api.blockcypher.com/v1/btc/main`
- Price sources (tried in order):
  - `https://api.coingecko.com/api/v3/simple/price?ids=bitcoin&vs_currencies=usd`
  - `https://api.binance.com/api/v3/ticker/price?symbol=BTCUSDT`

## Notes

- External API requests are always network-only; the service worker does not cache them.
- The app shell is cached for offline use. Install prompt appears when criteria are met.
- Settings persist in LocalStorage: auto-update toggles and polling interval.

## Quick start

```
npm install
npm run icons     # generate PNGs and Apple touch icon
npm run dev      # http://localhost:5175
npm run build
npm run preview  # http://localhost:5174
```

## Stack

- Vue 3 + Vue Router (SPA)
- Vite
- vite-plugin-pwa (registerType: autoUpdate; Workbox with skipWaiting + clientsClaim)

## Docs

- Authoritative template docs: `docs/VUE.md` (Vue + Vite + vite-plugin-pwa)
- cashu.me reference docs (Quasar-based): `docs/PWA.md`, `docs/FAQ.md` (kept for background; concepts map to Vite equivalents)
- Submodule (do not edit): `Inspiration/cashu.me/`

## Service worker & caching

- SW is generated by vite-plugin-pwa and registered via `useRegisterSW` in `src/App.vue`.
- Only the app shell is precached. External APIs (height/price) are fetched with `cache: 'no-store'` and are never cached by the SW.

## Icons

- Development icons live in `public/icons/` and are referenced by the PWA manifest configured in `vite.config.js`.
- SVG sources: `public/icons/icon-192.svg`, `public/icons/icon-512.svg`.
- PNGs (preferred by many platforms): `public/icons/icon-192.png`, `public/icons/icon-512.png`.
- Apple touch icon: `public/icons/apple-touch-icon.png`.
- Generate icons from SVGs: run `npm run icons`.

## Hosting (SPA history fallback)

- Netlify or Cloudflare Pages: add a `_redirects` file at the repo root or in `public/` containing:
  ```
  /* /index.html 200
  ```
- Vercel: add `vercel.json` with:
  ```
  {
    "rewrites": [{ "source": "/(.*)", "destination": "/index.html" }]
  }
  ```
- Nginx:
  ```
  location / {
    try_files $uri $uri/ /index.html;
  }
  ```
- Apache (`.htaccess`):
  ```
  <IfModule mod_rewrite.c>
    RewriteEngine On
    RewriteBase /
    RewriteRule ^index\.html$ - [L]
    RewriteCond %{REQUEST_FILENAME} !-f
    RewriteCond %{REQUEST_FILENAME} !-d
    RewriteRule . /index.html [L]
  </IfModule>
  ```
- GitHub Pages: copy `dist/index.html` to `dist/404.html` during deploy so unknown routes serve the SPA.
